# Usamos una versión específica para mayor predictibilidad
FROM fedora:42

# 1. Definir variables de entorno necesarias
# Eliminamos DEBIAN_FRONTEND porque Fedora usa DNF
ENV LANG=en_US.UTF-8 \
    LC_ALL=en_US.UTF-8

# 2. Instalación de paquetes en una sola capa y limpieza inmediata
# Usamos --setopt para evitar dependencias débiles y reducir espacio
RUN dnf -y update && \
    dnf -y install \
    sudo \
    git \
    wget \
    bc \
    curl \
    vim-minimal \
    nano \
    iproute \
    iputils && \
    dnf clean all && \
    rm -rf /var/cache/dnf

# 3. Configuración de usuario y directorios
# Combinamos la creación de usuario, permisos y carpetas para evitar capas extra de metadatos
RUN useradd -m -s /bin/bash willians && \
    echo "willians ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers && \
    mkdir -p /home/willians/{laravel,pkg,legacy} && \
    chown -R willians:willians /home/willians

# 4. Configuración de entorno de trabajo
USER willians
WORKDIR /home/willians

# El default de Fedora suele ser bash, pero lo explicitamos
CMD ["/bin/bash"]